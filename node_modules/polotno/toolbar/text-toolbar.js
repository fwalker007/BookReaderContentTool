"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.TextToolbar=exports.SpacingInput=exports.FontColorInput=exports.FontStyleGroup=exports.FontSizeInput=exports.FontFamilyInput=void 0;var react_1=__importDefault(require("react")),mobx_react_lite_1=require("mobx-react-lite"),core_1=require("@blueprintjs/core"),select_1=require("@blueprintjs/select"),fonts_1=require("../utils/fonts"),color_picker_1=__importDefault(require("./color-picker")),filters_picker_1=__importDefault(require("./filters-picker")),MdcFormatLineSpacing_1=__importDefault(require("@meronex/icons/mdc/MdcFormatLineSpacing"));exports.FontFamilyInput=mobx_react_lite_1.observer((function(e){var t=e.element,n=e.store,r=n.fonts.map((function(e){return e.fontFamily})).concat(fonts_1.getFontsList());react_1.default.useEffect((function(){r.forEach((function(e){n.loadFont(e)}))}),[r]);var o=t.fontFamily;return o.length>15&&(o=t.fontFamily.slice(0,15)+"..."),react_1.default.createElement(select_1.Select,{items:r,itemRenderer:function(e,t){var n=t.handleClick,r=t.modifiers,o=t.query;return-1===e.toLowerCase().indexOf(o.toLowerCase())?null:react_1.default.createElement(core_1.MenuItem,{key:e,text:e,active:r.active,disabled:r.disabled,onClick:n,style:{fontFamily:'"'+e+'"'}})},activeItem:t.fontFamily,onItemSelect:function(e){t.set({fontFamily:e})}},react_1.default.createElement(core_1.Button,{text:o,rightIcon:"caret-down",minimal:!0,style:{marginRight:"5px",fontFamily:'"'+t.fontFamily+'"',overflow:"hidden",whiteSpace:"nowrap"}}))})),exports.FontSizeInput=mobx_react_lite_1.observer((function(e){var t=e.element;return react_1.default.createElement(core_1.NumericInput,{onValueChange:function(e){t.set({fontSize:e})},value:Math.round(t.fontSize),style:{width:"50px"},min:5})}));var ALIGN_OPTIONS=["left","center","right"];exports.FontStyleGroup=mobx_react_lite_1.observer((function(e){var t=e.element;return react_1.default.createElement(core_1.ButtonGroup,null,react_1.default.createElement(core_1.Button,{minimal:!0,icon:"align-"+t.align,onClick:function(){var e=(ALIGN_OPTIONS.indexOf(t.align)+1+ALIGN_OPTIONS.length)%ALIGN_OPTIONS.length,n=ALIGN_OPTIONS[e];t.set({align:n})}}),react_1.default.createElement(core_1.Button,{minimal:!0,icon:"bold",active:"bold"===t.fontWeight||"700"===t.fontWeight,onClick:function(){"bold"===t.fontWeight||"700"===t.fontWeight?t.set({fontWeight:"normal"}):t.set({fontWeight:"bold"})}}),react_1.default.createElement(core_1.Button,{minimal:!0,icon:"italic",active:"italic"===t.fontStyle,onClick:function(){"italic"===t.fontStyle?t.set({fontStyle:"normal"}):t.set({fontStyle:"italic"})}}),react_1.default.createElement(core_1.Button,{minimal:!0,icon:"underline",active:t.textDecoration.indexOf("underline")>=0,onClick:function(){var e=t.textDecoration.split(" ");e.indexOf("underline")>=0?e=e.filter((function(e){return"underline"!==e})):e.push("underline"),t.set({textDecoration:e.join(" ")})}}))})),exports.FontColorInput=mobx_react_lite_1.observer((function(e){var t=e.element;return react_1.default.createElement(color_picker_1.default,{value:t.fill,onChange:function(e){return t.set({fill:e})}})})),exports.SpacingInput=mobx_react_lite_1.observer((function(e){var t=e.element;return react_1.default.createElement(core_1.Popover,{content:react_1.default.createElement("div",{style:{padding:"15px 25px",width:"200px"}},react_1.default.createElement("p",null,"Line height"),react_1.default.createElement(core_1.Slider,{value:"number"==typeof t.lineHeight?100*t.lineHeight:120,labelStepSize:50,onChange:function(e){t.set({lineHeight:e/100})},min:50,max:250,stepSize:10,showTrackFill:!0}),react_1.default.createElement("p",null,"Letter spacing"),react_1.default.createElement(core_1.Slider,{value:100*t.letterSpacing,labelStepSize:50,onChange:function(e){t.set({letterSpacing:e/100})},min:-50,max:250,stepSize:10,showTrackFill:!1})),position:core_1.Position.BOTTOM},react_1.default.createElement(core_1.Button,{icon:react_1.default.createElement(MdcFormatLineSpacing_1.default,{className:"bp3-icon",style:{fontSize:"20px"}}),minimal:!0}))}));var PROPS_MAP={font:exports.FontFamilyInput,fontSize:exports.FontSizeInput,fontVariant:exports.FontStyleGroup,filter:filters_picker_1.default,fontColor:exports.FontColorInput,spacing:exports.SpacingInput};exports.TextToolbar=mobx_react_lite_1.observer((function(e){var t=e.store,n=e.hideTextEffects,r=e.hideTextSpacing,o=e.hideTextBold,i=e.hideTextItalic,l=e.hideTextUnderline,a=t.selectedElements[0],c=["fontColor","font","fontSize","fontVariant",!r&&"spacing",!n&&"filter"].filter((function(e){return!!e}));return react_1.default.createElement(core_1.Navbar.Group,{align:core_1.Alignment.LEFT,style:{width:"calc(100% - 450px)"}},react_1.default.createElement(core_1.OverflowList,{items:c,style:{width:"100%"},visibleItemRenderer:function(e){var n=PROPS_MAP[e];return react_1.default.createElement(n,{element:a,store:t,key:e,hideTextBold:o,hideTextItalic:i,hideTextUnderline:l})},collapseFrom:core_1.Boundary.END,overflowRenderer:function(e){return react_1.default.createElement(core_1.Popover,{content:react_1.default.createElement("div",{style:{padding:"10px",display:"flex"}},e.map((function(e){var n=PROPS_MAP[e];return react_1.default.createElement(n,{key:e,element:a,store:t,hideTextBold:o,hideTextItalic:i,hideTextUnderline:l})}))),position:core_1.Position.BOTTOM},react_1.default.createElement(core_1.Button,{icon:"more",minimal:!0,style:{marginLeft:"20px"}}))}}))})),exports.default=exports.TextToolbar;