"use strict";var __makeTemplateObject=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},__awaiter=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,o){function l(e){try{u(a.next(e))}catch(e){o(e)}}function i(e){try{u(a.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,i)}u((a=a.apply(e,t||[])).next())}))},__generator=this&&this.__generator||function(e,t){var r,a,n,o,l={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,a&&(n=2&o[0]?a.return:o[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,o[1])).done)return n;switch(a=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,a=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!(n=l.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){l=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){l.label=o[1];break}if(6===o[0]&&l.label<n[1]){l.label=n[1],n=o;break}if(n&&l.label<n[2]){l.label=n[2],l.ops.push(o);break}n[2]&&l.ops.pop(),l.trys.pop();continue}o=t.call(e,l)}catch(e){o=[6,e],a=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.BackgroundPanel=void 0;var templateObject_1,react_1=__importDefault(require("react")),mobx_react_lite_1=require("mobx-react-lite"),swr_1=require("swr"),styled_1=__importDefault(require("./styled")),core_1=require("@blueprintjs/core"),react_color_1=require("react-color"),IosColorPalette_1=__importDefault(require("@meronex/icons/ios/IosColorPalette")),images_grid_1=require("./images-grid"),base_url_1=require("../utils/base-url"),validate_key_1=require("../utils/validate-key"),colors=["white","rgb(82, 113, 255)","rgb(255, 145, 77)","rgb(126, 217, 87)","rgb(255, 222, 89)","rgb(203, 108, 230)","rgb(255, 87, 87)"],Colored=styled_1.default("div")(templateObject_1||(templateObject_1=__makeTemplateObject(["\n  display: inline-block;\n  width: 30px;\n  height: 30px;\n  border-radius: 2px;\n  box-shadow: 0 0 2px rgba(16, 22, 26, 0.3);\n  cursor: pointer;\n"],["\n  display: inline-block;\n  width: 30px;\n  height: 30px;\n  border-radius: 2px;\n  box-shadow: 0 0 2px rgba(16, 22, 26, 0.3);\n  cursor: pointer;\n"])));exports.BackgroundPanel=mobx_react_lite_1.observer((function(e){var t,r,a,n=e.store,o=swr_1.useSWRInfinite((function(e){return base_url_1.API+"/get-unsplash?query=pattern&per_page=20&page="+(e+1)+"&KEY="+validate_key_1.getKey()}),{revalidateOnFocus:!1}),l=o.data,i=o.error,u=o.size,c=o.setSize,s=!l&&!i||!!(u>0&&l&&void 0===l[u-1]),d=0===(null===(t=null==l?void 0:l[0])||void 0===t?void 0:t.length)||l&&l[0].total_pages===u;return react_1.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column"}},react_1.default.createElement("div",{style:{display:"flex",justifyContent:"space-around",paddingBottom:"10px"}},react_1.default.createElement(core_1.Popover,{content:react_1.default.createElement(react_color_1.SketchPicker,{color:null===(r=n.activePage)||void 0===r?void 0:r.background,onChangeComplete:function(e){var t,r=e.rgb,a=r.r,o=r.g,l=r.b,i=r.a;null===(t=n.activePage)||void 0===t||t.set({background:"rgba("+a+","+o+","+l+","+i+")"})}}),target:react_1.default.createElement(Colored,{style:{backgroundColor:null===(a=n.activePage)||void 0===a?void 0:a.background,fontSize:"30px"}},react_1.default.createElement(IosColorPalette_1.default,{style:{mixBlendMode:"difference"}}))}),colors.map((function(e){return react_1.default.createElement(Colored,{key:e,style:{backgroundColor:e},onClick:function(){var t;null===(t=n.activePage)||void 0===t||t.set({background:e})}})}))),react_1.default.createElement(images_grid_1.ImagesGrid,{images:null==l?void 0:l.map((function(e){return e.results})).flat(),isLoading:s,getPreview:function(e){return e.urls.small},loadMore:function(){d||c(u+1)},onSelect:function(e){return __awaiter(void 0,void 0,void 0,(function(){var t;return __generator(this,(function(r){return fetch(base_url_1.API+"/download-unsplash?id="+e.id+"&KEY="+validate_key_1.getKey()),null===(t=n.activePage)||void 0===t||t.set({background:e.urls.regular}),[2]}))}))},getCredit:function(e){return react_1.default.createElement("span",null,"Photo by"," ",react_1.default.createElement("a",{href:"https://unsplash.com/@"+e.user.username+"?utm_source=polotno&utm_medium=referral"},e.user.name)," ","on"," ",react_1.default.createElement("a",{href:"https://unsplash.com/?utm_source=polotno&utm_medium=referral"},"Unsplash"))}}))}));