{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (e, t, r, a) {\n  return new (r || (r = Promise))(function (n, l) {\n    function u(e) {\n      try {\n        o(a.next(e));\n      } catch (e) {\n        l(e);\n      }\n    }\n\n    function i(e) {\n      try {\n        o(a.throw(e));\n      } catch (e) {\n        l(e);\n      }\n    }\n\n    function o(e) {\n      var t;\n      e.done ? n(e.value) : (t = e.value, t instanceof r ? t : new r(function (e) {\n        e(t);\n      })).then(u, i);\n    }\n\n    o((a = a.apply(e, t || [])).next());\n  });\n},\n    __generator = this && this.__generator || function (e, t) {\n  var r,\n      a,\n      n,\n      l,\n      u = {\n    label: 0,\n    sent: function sent() {\n      if (1 & n[0]) throw n[1];\n      return n[1];\n    },\n    trys: [],\n    ops: []\n  };\n  return l = {\n    next: i(0),\n    throw: i(1),\n    return: i(2)\n  }, \"function\" == typeof Symbol && (l[Symbol.iterator] = function () {\n    return this;\n  }), l;\n\n  function i(l) {\n    return function (i) {\n      return function (l) {\n        if (r) throw new TypeError(\"Generator is already executing.\");\n\n        for (; u;) {\n          try {\n            if (r = 1, a && (n = 2 & l[0] ? a.return : l[0] ? a.throw || ((n = a.return) && n.call(a), 0) : a.next) && !(n = n.call(a, l[1])).done) return n;\n\n            switch (a = 0, n && (l = [2 & l[0], n.value]), l[0]) {\n              case 0:\n              case 1:\n                n = l;\n                break;\n\n              case 4:\n                return u.label++, {\n                  value: l[1],\n                  done: !1\n                };\n\n              case 5:\n                u.label++, a = l[1], l = [0];\n                continue;\n\n              case 7:\n                l = u.ops.pop(), u.trys.pop();\n                continue;\n\n              default:\n                if (!(n = u.trys, (n = n.length > 0 && n[n.length - 1]) || 6 !== l[0] && 2 !== l[0])) {\n                  u = 0;\n                  continue;\n                }\n\n                if (3 === l[0] && (!n || l[1] > n[0] && l[1] < n[3])) {\n                  u.label = l[1];\n                  break;\n                }\n\n                if (6 === l[0] && u.label < n[1]) {\n                  u.label = n[1], n = l;\n                  break;\n                }\n\n                if (n && u.label < n[2]) {\n                  u.label = n[2], u.ops.push(l);\n                  break;\n                }\n\n                n[2] && u.ops.pop(), u.trys.pop();\n                continue;\n            }\n\n            l = t.call(e, u);\n          } catch (e) {\n            l = [6, e], a = 0;\n          } finally {\n            r = n = 0;\n          }\n        }\n\n        if (5 & l[0]) throw l[1];\n        return {\n          value: l[0] ? l[1] : void 0,\n          done: !0\n        };\n      }([l, i]);\n    };\n  }\n},\n    __importDefault = this && this.__importDefault || function (e) {\n  return e && e.__esModule ? e : {\n    default: e\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: !0\n}), exports.PhotosPanel = void 0;\n\nvar react_1 = __importDefault(require(\"react\")),\n    core_1 = require(\"@blueprintjs/core\"),\n    swr_1 = require(\"swr\"),\n    images_grid_1 = require(\"./images-grid\"),\n    image_1 = require(\"../utils/image\"),\n    base_url_1 = require(\"../utils/base-url\"),\n    validate_key_1 = require(\"../utils/validate-key\"),\n    PhotosPanel = function PhotosPanel(e) {\n  var t,\n      r = e.store,\n      a = react_1.default.useRef(\"canvas\"),\n      n = react_1.default.useRef(),\n      l = swr_1.useSWRInfinite(function (e) {\n    return base_url_1.API + \"/get-unsplash?query=\" + a.current + \"&per_page=20&page=\" + (e + 1) + \"&KEY=\" + validate_key_1.getKey();\n  }, {\n    revalidateOnFocus: !1\n  }),\n      u = l.data,\n      i = l.error,\n      o = l.mutate,\n      s = l.size,\n      c = l.setSize,\n      f = (l.isValidating, !u && !i || !!(s > 0 && u && void 0 === u[s - 1])),\n      _ = 0 === (null === (t = null == u ? void 0 : u[0]) || void 0 === t ? void 0 : t.length) || u && u[0].total_pages === s,\n      d = react_1.default.useCallback(function (e) {\n    a.current = e, clearTimeout(n.current), n.current = setTimeout(function () {\n      o();\n    }, 500);\n  }, []);\n\n  return react_1.default.createElement(\"div\", {\n    style: {\n      height: \"100%\",\n      display: \"flex\",\n      flexDirection: \"column\"\n    }\n  }, react_1.default.createElement(core_1.InputGroup, {\n    leftIcon: \"search\",\n    placeholder: \"Search...\",\n    onChange: function onChange(e) {\n      d(e.target.value);\n    },\n    style: {\n      marginBottom: \"20px\"\n    }\n  }), react_1.default.createElement(\"p\", {\n    style: {\n      textAlign: \"center\"\n    }\n  }, \"Photos by\", \" \", react_1.default.createElement(\"a\", {\n    href: \"https://unsplash.com/\",\n    target: \"_blank\"\n  }, \"Unsplash\")), react_1.default.createElement(images_grid_1.ImagesGrid, {\n    images: null == u ? void 0 : u.map(function (e) {\n      return e.results;\n    }).flat(),\n    getPreview: function getPreview(e) {\n      return e.urls.small;\n    },\n    onSelect: function onSelect(e, t) {\n      return __awaiter(void 0, void 0, void 0, function () {\n        var a, n, l, u, i, o;\n        return __generator(this, function (s) {\n          switch (s.label) {\n            case 0:\n              return fetch(base_url_1.API + \"/download-unsplash?id=\" + e.id + \"&KEY=\" + validate_key_1.getKey()), [4, image_1.getImageSize(e.urls.small)];\n\n            case 1:\n              return a = s.sent(), n = a.width, l = a.height, u = ((null == t ? void 0 : t.x) || r.width / 2) - n / 2, i = ((null == t ? void 0 : t.y) || r.height / 2) - l / 2, null === (o = r.activePage) || void 0 === o || o.addElement({\n                type: \"image\",\n                src: e.urls.regular,\n                width: n,\n                height: l,\n                x: u,\n                y: i\n              }), [2];\n          }\n        });\n      });\n    },\n    isLoading: f,\n    loadMore: function loadMore() {\n      _ || c(s + 1);\n    },\n    getCredit: function getCredit(e) {\n      return react_1.default.createElement(\"span\", null, \"Photo by\", \" \", react_1.default.createElement(\"a\", {\n        href: \"https://unsplash.com/@\" + e.user.username + \"?utm_source=polotno&utm_medium=referral\"\n      }, e.user.name), \" \", \"on\", \" \", react_1.default.createElement(\"a\", {\n        href: \"https://unsplash.com/?utm_source=polotno&utm_medium=referral\"\n      }, \"Unsplash\"));\n    }\n  }));\n};\n\nexports.PhotosPanel = PhotosPanel;","map":null,"metadata":{},"sourceType":"script"}