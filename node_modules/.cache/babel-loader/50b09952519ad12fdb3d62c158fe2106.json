{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (e, t, n, o) {\n  return new (n || (n = Promise))(function (r, a) {\n    function i(e) {\n      try {\n        l(o.next(e));\n      } catch (e) {\n        a(e);\n      }\n    }\n\n    function s(e) {\n      try {\n        l(o.throw(e));\n      } catch (e) {\n        a(e);\n      }\n    }\n\n    function l(e) {\n      var t;\n      e.done ? r(e.value) : (t = e.value, t instanceof n ? t : new n(function (e) {\n        e(t);\n      })).then(i, s);\n    }\n\n    l((o = o.apply(e, t || [])).next());\n  });\n},\n    __generator = this && this.__generator || function (e, t) {\n  var n,\n      o,\n      r,\n      a,\n      i = {\n    label: 0,\n    sent: function sent() {\n      if (1 & r[0]) throw r[1];\n      return r[1];\n    },\n    trys: [],\n    ops: []\n  };\n  return a = {\n    next: s(0),\n    throw: s(1),\n    return: s(2)\n  }, \"function\" == typeof Symbol && (a[Symbol.iterator] = function () {\n    return this;\n  }), a;\n\n  function s(a) {\n    return function (s) {\n      return function (a) {\n        if (n) throw new TypeError(\"Generator is already executing.\");\n\n        for (; i;) {\n          try {\n            if (n = 1, o && (r = 2 & a[0] ? o.return : a[0] ? o.throw || ((r = o.return) && r.call(o), 0) : o.next) && !(r = r.call(o, a[1])).done) return r;\n\n            switch (o = 0, r && (a = [2 & a[0], r.value]), a[0]) {\n              case 0:\n              case 1:\n                r = a;\n                break;\n\n              case 4:\n                return i.label++, {\n                  value: a[1],\n                  done: !1\n                };\n\n              case 5:\n                i.label++, o = a[1], a = [0];\n                continue;\n\n              case 7:\n                a = i.ops.pop(), i.trys.pop();\n                continue;\n\n              default:\n                if (!(r = i.trys, (r = r.length > 0 && r[r.length - 1]) || 6 !== a[0] && 2 !== a[0])) {\n                  i = 0;\n                  continue;\n                }\n\n                if (3 === a[0] && (!r || a[1] > r[0] && a[1] < r[3])) {\n                  i.label = a[1];\n                  break;\n                }\n\n                if (6 === a[0] && i.label < r[1]) {\n                  i.label = r[1], r = a;\n                  break;\n                }\n\n                if (r && i.label < r[2]) {\n                  i.label = r[2], i.ops.push(a);\n                  break;\n                }\n\n                r[2] && i.ops.pop(), i.trys.pop();\n                continue;\n            }\n\n            a = t.call(e, i);\n          } catch (e) {\n            a = [6, e], o = 0;\n          } finally {\n            n = r = 0;\n          }\n        }\n\n        if (5 & a[0]) throw a[1];\n        return {\n          value: a[0] ? a[1] : void 0,\n          done: !0\n        };\n      }([a, s]);\n    };\n  }\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: !0\n}), exports.validateKey = exports.getKey = void 0;\n\nvar base_url_1 = require(\"./base-url\"),\n    API_KEY = \"\",\n    getKey = function getKey() {\n  return API_KEY || \"\";\n};\n\nexports.getKey = getKey;\nvar ATTEMPTS = 5,\n    TIMEOUT = 3e3,\n    NO_KEY_MESSAGE = \"Polotno API is initialized without API key. It may lead to unexpected behavior and stop working. Please create API key here: https://polotno.dev/cabinet\",\n    NO_VALID_MESSAGE = \"Polotno API key is not valid. Please get new API key here: https://polotno.dev/cabinet\",\n    ERROR_MESSAGE = \"Can not validate Polotno API key. Please report to anton@polotno.dev immediately.\",\n    NOT_PAID_MESSAGE = \"%cPolotno Free Version. Development or non-commercial usage only. https://polotno.dev/\",\n    BAD_DOMAIN_MESSAGE = 'Polotno error! Current domain is not allowed. It may lead to unexpected behavior and stop working. Please add \"' + location.origin + '\" here: https://polotno.dev/cabinet';\n\nfunction validateKey(e) {\n  return __awaiter(this, void 0, void 0, function () {\n    var t, n, o;\n    return __generator(this, function (r) {\n      switch (r.label) {\n        case 0:\n          API_KEY = e, t = 0, r.label = 1;\n\n        case 1:\n          if (!(t < ATTEMPTS)) return [3, 10];\n          r.label = 2;\n\n        case 2:\n          return r.trys.push([2, 7,, 9]), [4, fetch(base_url_1.API + \"/validate-key\", {\n            method: \"POST\",\n            body: JSON.stringify({\n              key: e,\n              site: location.href\n            })\n          })];\n\n        case 3:\n          return n = r.sent(), e ? 200 === n.status ? [3, 5] : [4, new Promise(function (e) {\n            return setTimeout(e, TIMEOUT);\n          })] : (console.warn(NO_KEY_MESSAGE), [2, !1]);\n\n        case 4:\n          return r.sent(), [3, 9];\n\n        case 5:\n          return [4, n.json()];\n\n        case 6:\n          return (o = r.sent()).is_valid || console.warn(NO_VALID_MESSAGE), o.is_paid || console.log(NOT_PAID_MESSAGE, \"background: rgb(0, 161, 255); color: white; padding: 5px; margin: 5px;\"), o.is_domain_valid || console.warn(BAD_DOMAIN_MESSAGE), [2, o.is_paid || !1];\n\n        case 7:\n          return r.sent(), [4, new Promise(function (e) {\n            return setTimeout(e, TIMEOUT);\n          })];\n\n        case 8:\n          return r.sent(), [3, 9];\n\n        case 9:\n          return t++, [3, 1];\n\n        case 10:\n          return console.error(ERROR_MESSAGE), [2, !0];\n      }\n    });\n  });\n}\n\nexports.validateKey = validateKey;","map":null,"metadata":{},"sourceType":"script"}