{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (e) {\n  return e && e.__esModule ? e : {\n    default: e\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: !0\n}), exports.Workspace = void 0;\n\nvar react_1 = __importDefault(require(\"react\")),\n    mobx_react_lite_1 = require(\"mobx-react-lite\"),\n    page_1 = __importDefault(require(\"./page\")),\n    hotkeys_1 = require(\"./hotkeys\"),\n    MIN_PADDING = 20,\n    ZERO_SIZE_WARNING = \"Polotno warning: <Workspace /> component can not automatically detect its size.\\nWidth or height of parent elements is equal 0.\\nPlease make sure it has non-zero size. You may need to adjust it with your styles. <Workspace /> will automatically fit into parent container.\\nFor simpler debugging here is the log of the parent element:\",\n    useAutoScroll = function useAutoScroll(e, t, r, a, n) {\n  var o = react_1.default.useRef({\n    width: t,\n    height: r\n  }),\n      i = react_1.default.useRef({\n    top: 0,\n    left: 0\n  });\n  react_1.default.useEffect(function () {\n    var t = e.current,\n        r = function r() {\n      i.current = {\n        top: t.scrollTop,\n        left: t.scrollLeft\n      };\n    };\n\n    return t.addEventListener(\"scroll\", r), function () {\n      t.removeEventListener(\"scroll\", r);\n    };\n  }, []), react_1.default.useLayoutEffect(function () {\n    if (e.current) {\n      var a = e.current,\n          n = (i.current.left + a.offsetWidth / 2) / o.current.width,\n          l = (i.current.top + a.offsetHeight / 2) / o.current.height;\n      a.scrollLeft = n * t - a.offsetWidth / 2, a.scrollTop = l * r - a.offsetHeight / 2, o.current = {\n        width: t,\n        height: r\n      };\n    }\n  }, [a, t, r]);\n};\n\nexports.Workspace = mobx_react_lite_1.observer(function (e) {\n  var t = e.store,\n      r = react_1.default.useState({\n    width: 100,\n    height: 100\n  }),\n      a = r[0],\n      n = r[1],\n      o = react_1.default.useRef(null),\n      i = react_1.default.useRef(null),\n      l = function l() {\n    if (null !== o.current) {\n      var e = o.current.getBoundingClientRect();\n      0 !== e.width && 0 !== e.height || (console.warn(ZERO_SIZE_WARNING), console.log(o.current)), n({\n        width: e.width,\n        height: e.height\n      });\n      var r = (e.width - 2 * MIN_PADDING) / t.width,\n          a = (e.height - 2 * MIN_PADDING) / t.height,\n          i = Math.min(r, a);\n      t.setScale(i), t._setScaleToFit(i);\n    }\n  };\n\n  react_1.default.useEffect(l, [t.width, t.height]), react_1.default.useEffect(function () {\n    return window.addEventListener(\"resize\", l), function () {\n      return window.removeEventListener(\"resize\", l);\n    };\n  }, []);\n  var c = Math.max(MIN_PADDING, (a.width - t.width * t.scale) / 2),\n      u = Math.max(MIN_PADDING, (a.height - t.height * t.scale) / 2);\n  react_1.default.useEffect(function () {\n    var e = function e(_e) {\n      hotkeys_1.handleHotkey(_e, t);\n    };\n\n    return window.addEventListener(\"keydown\", e), function () {\n      return window.removeEventListener(\"keydown\", e);\n    };\n  }, []);\n  return useAutoScroll(i, t.width * t.scale + 2 * c, t.height * t.scale + 2 * u, t.scale, t), react_1.default.createElement(\"div\", {\n    ref: o,\n    style: {\n      width: \"100%\",\n      height: \"100%\",\n      position: \"relative\",\n      outline: \"none\"\n    },\n    tabIndex: 0\n  }, react_1.default.createElement(\"div\", {\n    ref: i,\n    onScroll: function onScroll(e) {\n      var r = e.currentTarget.childNodes[0].childNodes[0].offsetHeight,\n          a = e.currentTarget.scrollTop,\n          n = Math.floor((a + 100) / r),\n          o = t.pages[n];\n      o && o.select();\n    },\n    style: {\n      position: \"absolute\",\n      top: 0,\n      left: 0,\n      width: \"100%\",\n      height: \"100%\",\n      overflow: \"auto\"\n    }\n  }, t.pages.map(function (e) {\n    return react_1.default.createElement(page_1.default, {\n      key: e.id,\n      page: e,\n      xPadding: c,\n      yPadding: u,\n      width: t.width * t.scale + 2 * c,\n      height: t.height * t.scale + 2 * u,\n      store: t\n    });\n  }), 0 === t.pages.length && react_1.default.createElement(\"div\", {\n    style: {\n      position: \"absolute\",\n      top: \"50%\",\n      left: \"50%\",\n      transform: \"translate(-50%, -50%)\",\n      textAlign: \"center\"\n    }\n  }, react_1.default.createElement(\"p\", null, \"There are no pages yet... \"), react_1.default.createElement(\"button\", {\n    onClick: function onClick() {\n      t.addPage();\n    }\n  }, \"Add page\"))));\n}), exports.default = exports.Workspace;","map":null,"metadata":{},"sourceType":"script"}